@usedefault

h1. Port Forwards

Easily configure your port forwards to your Virtual Machines! Please take a small waiting period into account on a new deployed virtual machine, as it can still be starting or that your Defense Shield might still be in the process of assigning the IP address.

{{html:
	<div class="portMargin" ng-controller="PortforwardingController">
		<div>
			<div style="margin-bottom: 5px;">
				<button class="btn btn-info btn-large absolute1" ng-click="portForwardPopup()">Add</button>
			</div>
			<div class="table-responsive">
			<table class="table table-striped table-bordered">
				<tr>
					<th style=""><a href="" ng-click="predicate = 'ip'; reverse=!reverse">IP</a></th>
					<th><a href="" ng-click="predicate = 'puplicPort'; reverse=!reverse">Port</a></th>
					<th style=""><a href="" ng-click="predicate = 'vmName'; reverse=!reverse">Virtual Machine</a></th>
					<th><a href="" ng-click="predicate = 'localPort'; reverse=!reverse">Port</a></th>
					<th><a href="" ng-click="predicate = 'protocol'; reverse=!reverse">Protocol</a></th>
				</tr>
				<tbody>
					<tr ng-click="tableRowClicked(portforward)" ng-repeat="portforward in portforwarding | orderBy:predicate:reverse | groupBy:'ip' | groupBy:'vmName'">
						<td style="display: none;">{[portforward.id]}</td>
						<td style=" cursor: pointer;">{[portforward.publicIp]}</td>
						<td ng-click="portForwardPopupEdit()" style="cursor: pointer;">{[portforward.publicPort]}</td>
						<td style=" cursor: pointer;" ng-click="portForwardPopupEdit()">{[portforward.vmName]}</td>
						<td ng-click="portForwardPopupEdit()" style="cursor: pointer;">{[portforward.localPort]}</td>
						<td ng-click="portForwardPopupEdit()" style="cursor: pointer;">{[portforward.protocol]}</td>
					</tr>
				</tbody>
			</table>
			</div>
			  <p ng-show="message" class="alert alert-success span2 center txt-center">{[statusMessage]}</p>
		</div>
	</div>
	<script type="text/ng-template" id="portForwardDialog.html">
		<style type="text/css">
			.form-horizontal .control-label{
				width: 105px;
			}
			.form-horizontal .controls{
				margin-left: 0;
			}
			.row-fluid{
				width: 96%;
			}
			.form-horizontal .control-label{
				float: none;
			}
			.dropdown-menu{
				top: 28px;
			}
			.modal-body{
				overflow: visible;
				min-height: 240px;
			}
			#common-port-menu{
				padding: 4px 3px;
				border-top-right-radius: 0;
				border-bottom-right-radius: 0;
				width: 102px;
				float: left;
			}
			#inputNewPublicPort{
				width: 50%;
				border-top-left-radius: 0;
				border-bottom-left-radius: 0;
			}
			.modal-footer{
				padding: 19px 20px 30px;
			}
		</style>
        <form name="form" class="form-horizontal" ng-submit="submit()">
            <div class="modal-header">
                <h3>Port Forward</h3>
            </div>
            <div class="modal-body row-fluid">
            	<div class="col-md-5">
					<h4>Source</h4>
	            	<div class="control-group" style="min-height: 63px; margin-top: 0;" tourtip="Your Public IP, serviced by your Defense Shield. Set here what ports you are opening on your firewall. Type the port number or select from the preset ports">
						<label class="control-label" for="inputNewIP">Public IP</label>
						<div class="controls" style="height: 33px; line-height: 31px;">
					         {[currentSpace.publicipaddress]}
		       		</div>
						<label class="control-label" for="inputNewPublicPort">Port</label>
						<div class="controls">
							<autocomplete ng-model="newRule.publicPort" class="publicPort" click-activation="true" data="commonPorts" on-type="suggestCommonPorts"></autocomplete>
						</div>
						<label class="control-label" for="inputProtocol">Protocol</label>
						<div class="controls">
							<select ng-model="newRule.protocol" ng-options="o as o for o in ['tcp','udp']" class="form-control" style="width: 173px;">
							</select>
						</div>
					</div>
				</div>
				<div class="col-md-3">
				</div>
				<div class="col-md-4">
					<h4>Destination</h4>
					<div class="control-group" style="margin-top: 0;">
						<label class="control-label" style="width: 90%; ">Virtual Machine</label>
						<div class="controls">
							<select ng-model="newRule.VM" ng-options="machine.name for machine in currentSpace.machines" class="form-control" style="width: 173px;">
		                    </select>
		                </div>
						<label class="control-label" for="inputNewLocalPort">Port</label>
						<div class="controls">
							<autocomplete ng-model="newRule.localPort" class="localPort" click-activation="true" data="commonPorts" on-type="suggestCommonPorts"></autocomplete>
						</div>
					</div>
				</div>
            </div>
             <div class="modal-footer">
                <button type="submit" class="btn btn-primary ok">Ok</button>
                <button type="button" class="btn cancel" ng-click="cancel()">Cancel</button>
            </div>
         </form>
	</script>

	<script type="text/ng-template" id="editPortForwardDialog.html">
		<style type="text/css">
			.form-horizontal .control-label{
				width: 105px;
			}
			.form-horizontal .controls{
				margin-left: 0;
			}
			.row-fluid{
				width: 96%;
			}
			.form-horizontal .control-label{
				float: none;
			}
			.dropdown-menu{
				top: 28px;
			}
			.modal-body{
				min-height: 240px;
			}
			#common-port-menu{
				padding: 4px 3px;
				border-top-right-radius: 0;
				border-bottom-right-radius: 0;
				width: 102px;
				float: left;
			}
			#inputNewPublicPort{
				width: 50%;
				border-top-left-radius: 0;
				border-bottom-left-radius: 0;
			}
			.modal-footer{
				padding: 19px 20px 30px;
			}
		</style>
        <form name="form" class="form-horizontal" ng-submit="update()">
            <div class="modal-header">
                <h3>Edit Port Forward</h3>
            </div>
            <div class="modal-body row-fluid">
            	<div class="col-md-5">
					<h4>Source</h4>
	            	<div class="control-group" style="min-height: 63px; margin-top: 0;">
						<label class="control-label" for="inputNewIP">Public IP</label>
						<div class="controls" style="height: 33px; line-height: 31px;">
							{[currentSpace.publicipaddress]}
		       		</div>

						<label class="control-label" for="inputNewPublicPort">Port</label>
						<div class="controls">
							<autocomplete ng-model="editRule.publicPort" class="publicPort" click-activation="true" data="commonPorts" on-type="suggestCommonPorts"></autocomplete>
						</div>
						<label class="control-label" for="inputProtocol">Protocol</label>
						<div class="controls">
							<select ng-model="editRule.protocol" ng-options="o as o for o in ['tcp','udp']" class="form-control" style="width: 173px;">
							</select>
						</div>
					</div>
				</div>
				<div class="col-md-2">
				</div>
				<div class="col-md-4">
					<h4>Destination</h4>
					<div class="control-group" style="margin-top: 0;">
						<label class="control-label" style="width: 90%; ">Virtual Machine</label>
						<div class="controls">
							<select ng-model="editRule.VM.id" ng-options="machine.id as machine.name for machine in currentSpace.machines" class="form-control" style="width: 173px;">
		                    </select>
		                </div>

						<label class="control-label" for="inputNewLocalPort">Port</label>
						<div class="controls">
							<autocomplete ng-model="editRule.localPort" class="localPort" click-activation="true" data="commonPorts" on-type="suggestCommonPorts"></autocomplete>
						</div>
					</div>
				</div>
            </div>
             <div class="modal-footer">
                <button type="submit" class="btn btn-primary ok">Ok</button>
                <button type="button" class="btn cancel" ng-click="delete()">Delete</button>
                <button type="button" class="btn cancel" ng-click="cancel()">Cancel</button>
            </div>
         </form>
	</script>
    <script src="/$$space/.files/js/controllers/Portforwarding/PortforwardingController.js" type="text/javascript"></script>
		<script src="/$$space/.files/js/services/NetworkServices.js" type="text/javascript"></script>
		<script src="/$$space/.files/js/services/machineServices.js" type="text/javascript"></script>
}}
