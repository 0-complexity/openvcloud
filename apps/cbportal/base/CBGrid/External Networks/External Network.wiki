@usedefaults
@@title External Network: ${network} / ${subnetmask}
{{externalnetwork: networkid:$$networkid}}
{% if id %}

{{actions:
- display: Change Gateway
  action: /restmachine/cloudbroker/iaas/changeIPv4Gateway
  hide: true
  input:
  - label: Gateway IP Address
    type: text
    name: gateway
  data:
    subnet: ${id}

- display: Add External IP Addresses
  action: /restmachine/cloudbroker/iaas/addExternalIPS
  hide: true
  input:
  - label: Start IP Address
    type: text
    name: startip
  - label: End IP Address
    type: text
    name: endip
  data:
    externalnetworkId: ${id}
}}

{{datatables_use}}

h3. External Network

|*Network*|${network}|
|*Subnetmask*|${subnetmask}|
|*Gateway*|${gateway} {{action: id:'action-ChangeGateway' class:'glyphicon glyphicon-edit margin-bottom-medium margin-left-medium' label:''}} |

@HR

{% if ips %}
h4. Free IPs
{{action: id:'action-AddExternalIPAddresses' class:'glyphicon glyphicon-plus margin-bottom-medium margin-left-medium' label:'Add External IP Addresses'}}
||External IP||
{% for freeip in ips -%}
|${freeip}|
{% endfor %}
@HR
{% endif %}

h4. External IPs Used by CloudSpace
||External IP||Cloud Space||
{% for space in spaces -%}
|${space.externalnetworkip}|[${space.name} (${space.id})|cloud space?id=${space.id}]|
{% endfor %}

@HR

h4. External IPs Used by Virtual Machines
||Public IP||Virtual Machine||Cloud Space||
{% for vm in vms -%}
|${vm.externalnetworkip}|[${vm.name}|virtual machine?id=${vm.id}]|[${vm.cloudspaceId}|cloud space?id=${vm.cloudspaceId}]|
{% endfor %}

{% else %}
No External Network provided
{% endif %}
