
h1. Manage Machine
{{cssstyle
h1 { margin-bottom: 20px; }
}}
{{html:
<a ng-click="refreshPage()" class="refresh-page mtl right mTxt" style="margin-bottom: -20px;">
    <i class="fa fa-refresh"></i>
    Refresh
</a>
<tabset style="clear:both;">
      <tab id="actions" heading="Machine actions" active="tabactive.actions">
        <div id="actions" class="tab-pane active active2">
            <div class="row">
                <div class="span8">
                    <ul class="list">
                        <li>
                        	<div class="row">
                        		<div class="span3">Name</div>
                        		<div class="span9 mtm word-break">{[machine.name]}</div>
                        	</div>
                        </li>
                        <li>
                            <div class="row">
                                <div class="span3">Description</div>
                                <div class="span9 justify edit-description">
                                    <div ng-click="updateDescriptionPopup()" class="word-break">{[machine.description]}
                                        <span style="font-style:italic; display:none;" class="right edit-description-link">Edit</span>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                        	<div class="row">
                        		<div class="span3">Status</div>
                        		<div class="span9 mtm">{[machine.status]}</div>
                        	</div>
                        </li>
                        <li>
                        	<div class="row">
                        		<div class="span3">IP Address</div>
                        		<div class="span9 mtm">{[machine.interfaces[0].ipAddress]}</div>
                        	</div>
                        </li>
                        <li class="initial">
                        	<div class="row">
                        		<div class="span3">Initial Credentials</div>
                        		<div class="span9"><span class="mrl">Login: {[machine.accounts[0].login]}</span> <span>Password: {[machine.accounts[0].password]}</span></div>
                        	</div>
                        </li>
                        <li>
                        	<div class="row">
                        		<div class="span3">CPU</div>
                        		<div class="span9 mtm">{[machineinfo.size.vcpus]} <ng-pluralize count="machineinfo.size.vcpus" when="{'one': 'core', 'other': 'cores'}"></ng-pluralize></div>
                        	</div>
                        </li>
                        <li>
                        	<div class="row">
                                <div class="span3">Memory</div>
                        		<div class="span9 mtm">{[numeral(machineinfo.size.memory * 1024 *1024).format('0 b')]}</div>
                        	</div>
                        </li>
                        <li>
                        	<div class="row">
                        		<div class="span3">Storage</div>
                        		<div class="span9 mtm">{[ numeral(machineinfo.storage * 1024 * 1024 * 1024).format('0 b') ]}</div>
                        	</div>
                        </li>
                    </ul>
                </div>
                <div class="span3 actions">
                    <h4>Actions</h4>    <i ng-show="machine.locked == true" class="fa fa-large fa fa-lock"></i>
                    <ul class="actions">

                        <li ng-show="machine.status == 'HALTED' && machine.locked == false">
                            <a ng-click="start()">
                                <i class="fa fa-play-circle"></i>
                                Start
                            </a>
                        </li>

                        <li ng-show="machine.status == 'PAUSED'">
                            <a ng-click="resume()">
                                <i class="fa fa-play-circle"></i>
                                Resume
                            </a>
                        </li>

                        <li ng-show="machine.status == 'RUNNING'">
                            <a ng-click="pause()">
                                <i class=" fa fa-pause"></i>
                                Pause
                            </a>
                        </li>

                        <li ng-show="machine.status == 'RUNNING' && machine.locked == false">
                            <a ng-click="stop()">
                                <i class="fa fa-stop "></i>
                                Stop
                            </a>
                        </li>

                        <li>
                            <a ng-click="createSnapshot()" ng-class="{'action-disabled': machine.locked != false}">
                                <i class="fa fa-camera"></i>
                                Take Snapshot
                            </a>

			<script type="text/ng-template" id="createSnapshotDialog.html">
                            <form name="form" ng-submit="submit(form)">
                                <div class="modal-header">
                                    <h3>Take snapshot</h3>
                                </div>
                                <div class="modal-body">
                                    <ul>
                                        Name:
                                        <input ng-model="form.newSnapshotName" type="text" class="input-large" placeholder="Name"/>
                                    </ul>
                                </div>
                                 <div class="modal-footer">
                                    <button type="submit" class="btn btn-primary ok">Ok</button>
                                    <button type="button" class="btn cancel" ng-click="cancel()">Cancel</button>
                                </div>
                                </form>
			</script>

                        </li>

                        <li>
                            <a onclick="location.reload()">
                                <i class="fa fa-undo"></i>
                                Rebuild
                            </a>
                        </li>
                        <li>
                            <a ng-click="createTemplate()" ng-class="{'action-disabled': machine.locked != false}">
                                <i class="fa fa-copy"></i>
                                Create Template
                            </a>
							<script type="text/ng-template" id="createTemplateDialog.html">
                                <div class="modal-header">
                                    <h3>Create Template</h3>
                                </div>
                                <div class="modal-body">
                                    <ul>
                                        Name: <input ng-model="createtemplate.name" type="text" class="input-large" />
                                    </ul>
                                </div>
                                <div class="modal-footer">
                                    <button class="btn btn-primary ok" ng-click="ok()">Create Template</button>
                                    <button class="btn cancel" ng-click="cancel()">Cancel</button>
                                </div>
                            </script>
                        </li>
}}
#                        <li>
#                            <a>
#                                <i class="fa fa-download"></i>
#                                Export
#                            </a>
#                        </li>
{{html:
                        <li>
                            <a ng-click="destroy()">
                                <i class=" fa fa-times-circle-o"></i>
                                Destroy
                            </a>
                            <script type="text/ng-template" id="destroyMachineDialog.html">
                                <form name="destroyform" ng-submit="cancelDestroy()">
                                    <div class="modal-header">
                                        <h3>Destroy machine?</h3>
                                    </div>
                                    <div class="modal-body">
                                        <input type="hidden" value="hiddenmarker" name="hiddencsmarker"/>
                                        After destroying a machine all data is lost.
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn ok" ng-click="ok()">Ok</button>
                                        <button type="submit" id="submitdestroyform" class="btn btn-primary" autofocus>Cancel</button>
                                    </div>
                                </form>
                            </script>
                        </li>
                    </ul>
                </div>
            </div>
        <script type="text/ng-template" id="updateDescription.html">
                            <form name="form" class="form-horizontal" ng-submit="submit()">
                                <div class="modal-header">
                                    <h3>Edit Description</h3>
                                </div>
                                <div class="modal-body">
                                    <div class="control-group">
                                        <label class="control-label" for="inputNewCloudSpaceName">Description</label>
                                        <div class="controls">
                                            <textarea style="min-height: 80px;" ng-model="machine.newdescription" type="text" class="input-xlarge ng-pristine ng-valid" placeholder="Description"></textarea>
                                        </div>
                                    </div>
                                </div>
                                 <div class="modal-footer">
                                    <button type="submit" class="btn btn-primary ok">Ok</button>
                                    <button type="button" class="btn cancel" ng-click="cancel()">Cancel</button>
                                </div>
                                </form>
            </script>
        </div>
      </tab>
      <tab id="console" heading="Console" active="tabactive.console">
        <div id="console" class="tab-pane" ng-controller="ConsoleController">
            <div ng-model="machineConsoleUrlResult">
                <em style="display: block;" ng-show="machine.status == 'RUNNING'">Click the console screen or use the control buttons below to get access to the screen. In case of a black screen, 
                hit any key to disable the screen saving mode of your virtual machine.</em>
                <div class="error" ng-show="!!machineConsoleUrlResult.error">
                    The machine is not running.
                </div>
                <div class="row" ng-show="machine.status == 'RUNNING'">
                    <div class="span2">
                        <h4 class="machine-label mvn">IP Address</h4>
                        <p>
                            {[machine.interfaces[0].ipAddress]}    
                        </p>
                    </div>

                    <div class="span2">
                        <h4 class="machine-label mvn">login</h4>
                        <p>
                            {[machine.accounts[0].login]}
                        </p>
                    </div>
                    <div class="span2">
                        <h4 class="machine-label mvn">password</h4>
                        <p>
                            {[machine.accounts[0].password]}
                        </p>
                    </div>
                    <div class="span4" style="padding-top: 1%;">
                        <input id="capturekeyboardbutton" type=button class="btn mainButton btn-info left mrm" value="Capture keyboard"></input>
                        <div id="noVNC_buttons">
                        <input type=button class="btn mainButton btn-info" ng-click="rfb.sendCtrlAltDel()" value="Send CtrlAltDel"
                        id="sendCtrlAltDelButton">
                        </div>
                    </div>
                </div>
                <div novncwindow connectioninfo="novnc_connectioninfo">
        </div>
            </div>
        </div>
      </tab>
      <tab heading="Snapshots" active="tabactive.snapshots">


        <div id="snapshots" class="tab-pane tab-pane2">
            <a class="snap2" ng-click="createSnapshot()" ng-class="{'action-disabled': machine.locked != false}">
                <i class="fa fa-camera"></i>
                Take Snapshot
            </a>
            <table class="table table-bordered table-striped mtm" ng-show="snapshots.snapshots.length > 0">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Date</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="snapshot in snapshots.snapshots">
                        <td width="45%">{[snapshot.name]}</td>
                        <td style="white-space:nowrap" >
                            {[snapshot.epoch * 1000 | date:'medium']}
                        </td>
                        <td>
                            <a style="cursor: pointer" ng-show="machine.locked == false" ng-click="rollbackSnapshot(snapshot)">Rollback</a>
                            <a style="cursor: pointer" ng-show="machine.locked == false" ng-click="deleteSnapshot(snapshot)">Delete</a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
      </tab>
      <tab heading="Change Log" active="tabactive.changelog">
        <div id="logging" class="tab-pane">
            {{include:machine_history}}
        </div>
      </tab>
</tabset>

}}
